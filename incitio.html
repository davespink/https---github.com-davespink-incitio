<!DOCTYPE html>
<html lang="en">
<!--   My project for household management  
   
TODO: Look at JSON object
Start from empty data
Look at local storge

-->

<head>
  <meta charset="UTF-8">
  <title>Incitio v 0.1</title>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>

<style>
  h1 {
    font-size: 40px;
    text-align: center;
  }

  h2 {
    font-size: 40px;
  }

  p {
    font-size: 14px;
  }

  body {

    margin: 0px;
    padding: 0%;
    margin: 0%;
  }
</style>


<script>
  // globals
  let gButtonId = 0;
  let gHeaderThingType = "";




  function doNewButton(buttonText) {
    let newItemButton = document.createElement('button');
    let elItems = document.getElementById("allbuttons");
    elItems.appendChild(newItemButton);





    let stampx = new Date().getTime();
    let stamp = stampx.toString();
    stamp = stamp.slice(9);

    if (gThingType == "c") {
      bgColor = "blue";

    } else {
      bgColor = "green";
    }


    newItemButton.outerHTML =
      `<button id="item_` + stamp + `" class="btn btn-primary dropdown-toggle " type="button" data-bs-toggle="dropdown"
              aria-expanded="false" href="#" onclick="gButtonId=` + stamp + `"
              style="border-style:none;

              background-color:` + bgColor + `;
              
              margin-left:20px; margin-top: 20px;border-radius: 16px; ">`
      + buttonText + "-" + stamp +
      `</button>`;


    let newBranchButton = document.createElement('button');
    let elBranch = document.getElementById("branch");
    elBranch.appendChild(newBranchButton);


    bgColor = "brown";
    newBranchButton.outerHTML =
      `<button id="branch_` + stamp + `" class="btn btn-primary" type="button" data-bs-toggle="drpopdown"
              aria-expanded="false" href="#" onclick=("gButtonId=` + stamp + `) "
              style="border-style:none;

              background-color:` + bgColor + `;
              
              margin-left:20px; margin-top: 20px;border-radius: 16px; ">`
      + buttonText + "-" + stamp +
      `</button>`;


    // only last button is dropdown-toggle

    //    el=getElementById("branch_" + stamp);

    //      el.setAttribute("data-bs-toggle","dropdown");


    // next the chevron
    //  el.classList.add("dropdowm-toggle");

  }



  function modalSubmit() {

    // alert("submit");
    let itemName = document.getElementById("itemName");
    // alert(itemName.value);
    let el = document.getElementById("modal_close");
    el.click();

    setTimeout(doNewButton(itemName.value), 3000);
  }
  function doRemove() {

    let ebg = document.getElementById(gButtonId); ebg.remove();

  }


  function doDelete() {

    if (confirm('Are you sure you want to delete')) {

      setTimeout((() => { document.getElementById(gButtonId).remove(); }), 1000);


      console.log('Thing was deleted');
    } else {
      // Do nothing!
      console.log('Thing was not deleted');
    }


  }

  function doSelect() {

    alert(gButtonId);

    //  document.getElementById("branch").innerHTML += ">" + gButtonId;

  }



</script>


<body style="width:100%">

  <div style="width:100%;background-color: black">
    <div class="container" style="width:100%;">
      <div class="row">
        <div class="col-2" style="background-color:  rgb(160, 83, 128);justify-content: center;align-items: center">
          <button style="border-style: none;background-color: transparent;">
            <h1> <i class="bi-house" style="font-size: 6rem; color: cornflowerblue;"></i>InCitio</h1>
          </button>

          <div class="dropdown">
            <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown"
              aria-expanded="false" id="dropdownMenuButton"
              style="border-style: none;background-color:aquamarine;margin-left:20px; margin-top: 20px;border-radius: 16px; ">
              <h1>+New</h1>
            </button>

            <ul class="dropdown-menu">

              <li><a class="dropdown-item" data-bs-target="#myModal" href="#" data-bs-toggle="modal" onClick="
           
                gThingType='c';
                document.getElementById('headerThingType').innerText='Container';
                document.getElementById('itemThingType').innerHTML='Container Name';
            
                 ">New Container</a>
              </li>
              <li><a class="dropdown-item" data-bs-target="#myModal" href="#" data-bs-toggle="modal" onClick="
                   
                 gThingType='i';
                document.getElementById('headerThingType').innerText='Item';
                document.getElementById('itemThingType').innerHTML='Item Name';
                 "> New Item</a></li>
            </ul>
          </div>
          <p>


          </p>

        </div>



        <div class="col-6 mx-auto" style="background-color: rgb(41, 92, 67);padding: 10px ;">

          <button id="none" class="btn btn-light mx-auto" style="float:right; background-color:blanchedalmond;position: relative;
              width: 90%;height: 15%; border-radius: 16px; box-shadow: 5px 5px 5px gray;">
            <span class="btn-label" style="position:absolute;top:0px; left:10px; margin-bottom: 20px;">
              <i class="bi-search" style="font-size:30px"></i></span>
            <input aria-label="Search inCitio" autocomplete="off" placeholder="Search inCitio" value="" name=""
              type="text" style="padding: 0px; border:0cap; float:right;
            width: 90%;  background-color: rgb(219, 192, 192);
             z-index: 6; left: 0px;" spellcheck="false" aria-haspopup="true" aria-live="off" aria-owns="gs_sbt50">
          </button>

          <div id="branch" class="dropdown" style="margin-top: 100px; display:block ; background-color :blueviolet">
            <button id="home" class="btn btn-primary dropdown-toggle " type="button" data-bs-toggle="dropdown"
              aria-expanded="false" "   style=" border-style:none; background-color:rgb(128, 98, 0); margin-left:20px;
              margin-top: 20px;border-radius: 16px; ">Home</button>

              <ul class=" dropdown-menu">
              <li><a class="dropdown-item" href="#" onclick="doDelete( )">Delete Branch</a>
              </li>
              <li><a class="dropdown-item" href="#" onclick="doSelect( )">Select Branch</a></li>
              </ul>


          </div>

          <div id="allbuttons" class="dropdown" style="margin-top: 100px; display:block ; background-color :blueviolet">


            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" onclick="doDelete( )">Delete</a>
              </li>
              <li><a class="dropdown-item" href="#" onclick="doSelect( )">Select</a></li>
            </ul>


          </div>


          <!-- The Modal -->
          <div class="modal" id="myModal">
            <div class="modal-dialog">
              <div class="modal-content" style="width:80%">

                <!-- Modal Header -->
                <div class="modal-header">
                  <h4 id="headerThingType" class="modal-title">

                  </h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                  <form>
                    <div class="mb-3">
                      <label for="itemName" class="form-label" id="itemThingType">Item Name</label>
                      <input type="text" class="form-control" id="itemName" value="untitled" type="text">

                    </div>

                    <button type="button" onClick="modalSubmit()" class="btn btn-primary">Submit
                    </button>
                    <button id="modal_close" type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>

                  </form>
                </div>


              </div>
            </div>
          </div>

        </div>


        <div class="col-4" style="background-color: rgb(131, 107, 61); display:flex;justify-content: center; ">
          <div style="display:inline-block">
 

            <div id="picture_box" style="background-color: white;margin-top: 20px;   
             width:200px;height:200px;border: 1px solid black;  " contenteditable="true">
 
            </div>
            <p></p> <button style="margin-left: 50%;margin-right: 50%;">reset</button>
          </div>

        </div>
      </div>
    </div>
  </div>

  <script>

    function doBefore() {
      //    alert("before");

      let p = document.getElementById("picture_box");
      p.style.padding = "0px";
      p.innerHTML = "";
    }

    function doAfter() {

      // alert("doAfter");

      let p = document.getElementById("picture_box");
      let c = p.firstElementChild;
      let d = c.firstElementChild;
      if (c.tagName.toString() != "IMG") { alert("error"); return false; }

      //   d.style.height = "250px";
     c.style.width = "200px";


    }
    function hid(el) {
      el.display = "none";
    }

    document.getElementById("picture_box").addEventListener('paste',
      (ev) => {
        doBefore();
      }, true);

    document.getElementById("picture_box").addEventListener('paste',
      (ev) => {
        setTimeout(doAfter, 0);

      }, false);


    const pictureBoxReset = `<div class="picture" id="picture_box" style="display:flex ;justify-content: center;  
           background-color: white; position: absolute;margin-top: 20px;  padding:30px;
             width:200px;height:200px;border: 1px solid black;  " contenteditable="true">

            <button id="paste_btn" style="height:auto;padding:20px;"
            
            onclick="hid(this);
            let p = this.parentElement;  
            p.innerText = 'Now copy an image to the clipboard, THEN right click here to paste it'">
            
            left click here to start paste
            
          </button>
          </div>`;

  </script>

</body>



</html>
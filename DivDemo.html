<!DOCTYPE html>
<html lang="en">
<!--   

Demo Divs!
-->

<head>
    <meta charset="UTF-8">
    <title>Demo Div tag</title>

    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>



    <style>
        .myDiv {
            border: 5px outset red;

            text-align: center;
        }


        .body {
            width: 100%;
            margin: 0px;
            padding: 0px;
            margin: 0px;
        }
    </style>
    <script>
        function buttonSelected(buttonId) {

            let thisButton = document.getElementById(buttonId);

            let el = document.getElementById("inName");
            el.value = thisButton.innerText;

            el = document.getElementById("inItemId");
            el.value = buttonId;
        }

        function updateButtonName() {

            let thisButton = document.getElementById(inItemId.value);
            let newName = document.getElementById("inName");
            thisButton.innerText = newName.value;

            // change also in object array

        }

        function createButton(inType) {

            inName = prompt('Enter item name', 'unNamed');
            if (inName == null) return;


            let newButton = document.createElement('button');
            let elItemsDiv = document.getElementById("divItems");
            elItemsDiv.appendChild(newButton);


            let stampx = new Date().getTime();
            let stamp = stampx.toString();

            // TODO remove next line
            //     stamp = stamp.slice(9);

            buttonId = "item_" + stamp;

            if (inType == "c") {
                buttonColor = `btn btn-primary`;


            } else {
                buttonColor = `btn btn-success`;
            }



            let theHTML =
                `<button id="` + buttonId
                + `" onClick=buttonSelected("`
                + buttonId + `");  ondblclick=setCurrentRoot("`
                + stamp + `");    class="`
                + buttonColor
                + `" style="margin:5px">`
                + inName + `</button>`;

            // append info to gItem;
            newButton.outerHTML = theHTML

            newItem = Object.create(itemHome);
            newItem.id = stamp;
            newItem.parentId = gCurrentParentId;
            newItem.name = inName;
            newItem.description = "";

            gItemArray.push(newItem);





        }

        function setCurrentRoot(rootId) {

            // add to chain at top
             alert(rootId);

            let newButton = document.createElement('button');
            let elItemsDiv = document.getElementById("divChain");
            elItemsDiv.appendChild(newButton);


            //  inName = rootId;

            // get name from root it

            for (i = 0; i < gItemArray.length; i++) {
                //     alert(gItemArray[i].id);
                if (gItemArray[i].id == rootId) {
                    //   alert(gItemArray[i].name);

                    inName = gItemArray[i].name;
                }
            }

            buttonId = "chain_" + rootId;

            let theHTML =
                `<button id="` + buttonId
                + `" onClick=buttonSelected("`
                + buttonId + `");  ondblclick=setCurrentRoot("`
                + rootId + `");    class="btn btn-dark" style="margin:5px">`
                + inName + `</button>`;

            // append info to gItem;
            newButton.outerHTML = theHTML;

            // append info to gItem;
            gCurrentParentId = rootId;

            // remove from allButtons
            buttonId = "item_" + rootId;
            btn = document.getElementById(buttonId);

          //  btn.style.display = "none";

            btn.remove();
        }






    </script>
</head>

<body>

    <div style="display:inline-flex;width:100%">
        <!-- first column -->
        <div class="myDiv" style="width:20%;background-color:pink">

            <p></p>
            <button style="border-style: none;background-color: transparent;">
                <h1> <i class="bi-house" style="font-size: 6rem; color: cornflowerblue;"></i>InCitio</h1>
            </button>

            <div style="margin:auto">
                <button class="btn btn-primary dropdown-toggle " type="button" data-bs-toggle="dropdown"
                    id="dropdownMenuButton" style="border-style: none;  margin-top: 20px;border-radius: 16px; ">
                    <h1>+New</h1>
                </button>




                <ul class="dropdown-menu">

                    <li><a class="dropdown-item" href="#" onClick="createButton('c','x');">New Container</a>
                    </li>
                    <li><a class="dropdown-item" href="#" onClick="createButton('i','x');">New Item</a>
                    </li>
                </ul>



            </div>
            <div class="myDiv" style="margin-top:20px">

                <button onclick="{

               alert(JSON.stringify(gItemArray));

            }">To jason</button>


                <button>Fromjason</button>


            </div>




        </div>

        <p>
        <p></p>


        <!-- second column -->
        <div class="myDiv" style="width:70%;background-color:white">

            <div class="myDiv" style="background-color:rgb(68, 119, 94);margin:auto">



                <button id="none" class="btn btn-light" style="margin:30px; background-color:blanchedalmond;position: relative;
                width: 60%;height: 15%; border-radius: 16px; box-shadow: 5px 5px 5px gray;">
                    <span class="btn-label" style="position:absolute;top:0px; left:10px; margin-bottom: 20px;">
                        <i class="bi-search" style="font-size:30px"></i></span>

                    <input aria-label="Search inCitio" autocomplete="off" placeholder="Search inCitio" value="" name=""
                        type="text" style="padding: 0px; border:0cap; float:right;
              width: 90%;  background-color: rgb(219, 192, 192);
               z-index: 6; left: 0px;" spellcheck="false" aria-haspopup="true" aria-live="off" aria-owns="gs_sbt50">

                </button>



            </div>

            <div class="myDiv" style="background-color:white;margin:auto">



                <div id="divChain" style="text-align: left;margin-left: 10px;margin-bottom: 10px;" text-align: center;>


                    <button class="btn btn-primary" style="padding:0px;margin:0px ">
                        <h2>Home</h2>
                    </button>


                </div>


                <h2 style="text-align: left;margin:10px;">Items</h2>


                <div id="divItems" style="text-align: left;margin-left: 10px;margin-bottom: 10px; ">


                </div>

            </div>



            <div class="myDiv" style="background-color:rgb(92, 68, 119);margin:auto">
                <h2>This is a third div in a center element</h2>
                <p>This is some text in a div element.</p>
            </div>

        </div>





        <!-- third column -->
        <div class="myDiv" style="width:30%;background-color:white">

            <div class="myDiv" style="background-color:rgb(30, 218, 127);margin:20px ">


                <div id="picture_box" style="background-color: white;   margin:auto; 
                width:200px;height:200px;border: 1px solid black;  " contenteditable="true">

                </div>


            </div>


            <div style="background-color:white;margin:auto; padding:2px; ">
                <div style="text-align:left;background-color: cornsilk;margin-left: 10px;">
                    <form>

                        <div class="form-group">
                            <label for="inName">Name:</label>
                            <input type="text" class="form-control" id="inName">
                            <!--    <label><input type="checkbox"> Remember me</label> -->
                        </div>


                        <div class="form-group">
                            <label for="inDescription">Description</label>
                            <textarea class="form-control" id="inDescription" rows="5"></textarea>
                        </div>

                        <div class="form-group">
                            <input type="text" class="form-control" id="inItemId">
                        </div>

                        <div style="background-color: blueviolet;text-align:center">

                            <button type="button" class="btn btn-default btn-primary"
                                onclick="updateButtonName();">Update</button>
                        </div>





                </div>
            </div>



            <div class="myDiv" style="background-color:rgb(92, 68, 119);margin:auto">
                <h2>This is a third div in a center element</h2>
                <p>This is some text in a div element.</p>
            </div>

        </div>








    </div>



    <script>

        // Item
        const itemHome = {
            id: "0",
            parentId: "0",
            name: "home",
            description: "the root",
        };

        let gCurrentParentId = itemHome.id;

        const gItemArray = [];

        gItemArray.push(itemHome);


        /*
        newItem = Object.create(itemHome);
        newItem.id = 20;
        newItem.parentId = 2;
        newItem.name = "Kitchen";
        newItem.description = "MyRoom";

        gItemArray.push(newItem);*/

        x = 1;


    </script>


</body>




</html>